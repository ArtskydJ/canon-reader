<:Window on:keydown="keydown(event)" />

<:Head>
	<title>Canon Reader</title>
</:Head>

<uiView></uiView>

{{#if showReferenceSearch}}
<div class="search-container">
	<ReferenceSearch bind:show="showReferenceSearch" :mediator />
</div>
{{/if}}

<style>
.search-container {
	position: fixed;
	bottom: 32px;
	display: flex;
	justify-content: center;
	align-items: center;
	width: 100%;
}
</style>

<script>
import ReferenceSearch from 'component/ReferenceSearch.html'

const platform = (window.navigator && window.navigator.platform) || ''
const isMac = platform.slice(0,3).toLowerCase() === 'mac'
const code_k = 75

const isK = event => event.key === 'k' || event.keyCode === code_k
const isModified = event => event.ctrlKey || (isMac && event.metaKey)

export default {
	data() {
		return {
			showReferenceSearch: false
		}
	},
	methods: {
		keydown(event) {
			if (isK(event) && isModified(event)) {
				this.set({
					showReferenceSearch: true
				})
			}
		}
	},
	components: {
		ReferenceSearch
	}
}
</script>
